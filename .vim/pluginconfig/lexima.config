"note: neocompleteとkeymapの干渉あり -> cooperation_of_plugins.config

"initialize
let g:lexima_no_default_rules = 1
call lexima#set_default_rules()

"<C-h> to delete a pair of brackets
imap <C-h> <BS>
cmap <C-h> <BS>

"<Tab> escape
call lexima#add_rule({'char':'<TAB>', 'at':'\%#)',  'leave':1})
call lexima#add_rule({'char':'<TAB>', 'at':'\%#"',  'leave':1})
call lexima#add_rule({'char':'<TAB>', 'at':'\%#''', 'leave':1})
call lexima#add_rule({'char':'<TAB>', 'at':'\%#]',  'leave':1})
call lexima#add_rule({'char':'<TAB>', 'at':'\%#}',  'leave':1})

"insert space after ","
call lexima#add_rule({"at" : '\%#', "char" : ",", "input" : ",<Space>"})

"don't insert space twice after ","
call lexima#add_rule({"at" : ', \%#', "char" : '<Space>', "input" : ""})

"delete space when ", <CR>"
call lexima#add_rule({"at" : ', \%#', "char" : '<CR>', "input" : '<BS><CR>'})

"for latex
call lexima#add_rule({'char': '$',    'input_after': '$', 'filetype': 'tex'})
call lexima#add_rule({'char': '$',    'at': '\%#\$',      'leave': 1,  'filetype': 'tex'})
call lexima#add_rule({'char': '<BS>', 'at': '\$\%#\$',    'delete': 1, 'filetype': 'tex'})
call lexima#add_rule({'char':'<TAB>', 'at':'\%#\$',       'leave':1,   'filetype': 'tex'})












"function! s:set_lexima(rule)
"    call lexima#add_rule(a:rule)
"    let ignore_rule = a:rule
"    let ignore_rule.syntax = ["String", "Comment"]
"    let ignore_rule.input = ignore_rule.char
"    call lexima#add_rule(ignore_rule)
"endfunction

"call s:set_lexima({'at': '\%#',     'char': '[',    'input': '[]<Left>'})
"call s:set_lexima({'at': '\%#]',    'char': '[',    'input': '['})
"call s:set_lexima({'at': '\[\%#\]', 'char': ']',    'input': '<Right>'})
"call s:set_lexima({'at': '\[\%#\]', 'char': '[',    'input': '[]<Left>'})
"call s:set_lexima({'at': '\[\%#\]', 'char': '<BS>', 'input': '<BS><Del>'})

"for [begin, end] in [['(', ')'], ['{', '}']]
"    let bracket = begin.end
"    call s:set_lexima({'at': '\%#',     'char': begin, 'input': bracket.'<Left>'})
"    call s:set_lexima({'at': '\%#'.end, 'char': begin, 'input': begin})
"
"    call s:set_lexima({'at': begin.'\%#'.end, 'char': end,   'input': '<Right>'})
"    call s:set_lexima({'at': begin.'\%#'.end, 'char': begin, 'input': bracket.'<Left>'})
"    call s:set_lexima({'at': begin.'\%#'.end, 'char': '<BS>', 'input': '<BS><Del>'})
"endfor
